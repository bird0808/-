# 1.概述

Linux 允许不同的用户同时登录主机，同时使用主机的资源，因此 Linux 被称为是多用户系统

Linux 将用户账号、密码等相关的信息分别存储在四个文件夹下

- `/etc/passwd`  管理用户UID/GID重要参数

    ```text
    账号名称 : 密码 : UID : GID : 用户信息说明列 : 主文件夹 : shell
    root   : x    : 0   : 0   : root         : /root  : /bin/bash
    ```

    密码项显示 “x” 是出于安全考虑，Linux 将密码信息移到 /etc/shadow 进行存储；

    每一个用户都有一个UID、GID，对应的含义就是UserID、GroupID，UID 会映射到 /etc/shadow 以获得密码信息，GID 会映射到 /etc/group 以获取用户的用户组信息。

- `/etc/shadow` 管理用户密码

    ```text
    账号名称:密码 : 最近改动密码的日期 : 密码不可被改变的天数 : 密码需要重新更改的天数 : 更改提醒天数 : 密码过期后账号的宽限时间 : 账号失效日期 : 保留
    root  :密文 :  200             :0                 : 99999              :7            :::
    ```

    /etc/passwd 通过 UID，在该文件中找出对应 UID 的用户，并提取对应密码用于登陆验证

- `/etc/group` 管理用户组相关信息

    ```text
    用户组名称 : 用户组密码 : GID : 此用户组包含的账号名称
    root     : x        : 0    : root
    ```

    用户组密码通常是为了设置用户组管理员存在的，其信息也移动到 `/etc/gshadow` 中；

    `/etc/passwd` 通过 GID，在该文件中找到对应的用户组，并提取用户组相关信息；

    另外，由于一个用户可以在多个用户组中，因此就有一个初始用户组、有效用户组的概念。

    所谓的初始用户组，就是用户所记录的 GID，是在创建用户时生成或指定的用户组；

    所谓的有效用户组，就是利用命令`groups` 查看并输出的首个用户组，即有效用户组；

    用户在登录的时候，以初始用户组身份工作，用户可以用 `newgrp` 命令实现有效用户组的切换。

- `/etc/gshadow` 管理用户组管理员相关信息，一般用户组不使用用户组管理员，相应地也就不需要设置密码。

    ```text
    用户组名 : 密码 : 用户组管理员账号 : 该用户组包含的账号名称
    root : : : root
    ```

# 2.用户操作

- `id 用户名`：查看用户id，用户的用户组

- `su [-] [用户名]`:切换用户，`-`是可选的，加上表示切换用户后加载环境变量，不带用户名`su`直接切换到root用户，root可以不用密码切换到其他用户，其他普通用户切换用户需要密码。

- `sudo 其他命令`：使用sudo临时授权命令使用root权限执行，不是所有用户都有sudo权限，需要为普通用户配置sudo认证。
    root用户使用`visudo`命令，进入`/etc/sudoers`文件，最后一行添加`用户名 ALL=(ALL)  NOPASSWD:ALL`可以为一个用户添加sudo权限，NOPASSWD表示不需要输入密码。
    
- `useradd [选项] 用户名`：添加一个用户，增加用户账号就是在`/etc/passwd`文件中为新用户增加一条记录，同时更新其他系统文件如`/etc/shadow`, `/etc/group`等。Linux提供了集成的系统管理工具userconf，它可以用来对用户账号进行统一管理。
    - `-c` comment 指定一段注释性描述。
    - `-d` 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。默认创建和用户名同名的主目录
    - `-g` 指定用户所属的主用户组。不指定默认创建和用户名同名的组
    - `-G` 指定用户所属于的其他用户组
    - `-s` 指定用户的登录Shell。
    - `-u` 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。
    
- `userdel [-r] 用户名` 删除一个用户，加上-r可以把用户的home目录也删除了，home目录即`/home/用户目录`

- `usermod -aG 用户组 用户名` 将指定用户加入用户组

- `getent passwd` 查看所有用户

    

# 3.用户组

linux中可以针对用户、用户组来进行权限的控制。可以添加多个用户、用户组。同时一个用户能加入多个组。

- `groupadd 用户组名` 创建一个用户组
- `groupdel  用户组名` 删除一个用户组

    



